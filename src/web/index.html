<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Conversation Generator - Control Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f6fa;
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        header p {
            font-size: 1rem;
            color: #7f8c8d;
        }

        /* Scenario Selection Panel */
        .scenario-panel {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .panel-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #2c3e50;
            font-weight: 600;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .scenario-info-box {
            background: #f8f9fa;
            border-left: 4px solid #95a5a6;
            padding: 12px 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .scenario-info-box strong {
            color: #2c3e50;
        }

        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .scenario-card {
            border: 2px solid #e0e6ed;
            border-radius: 6px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .scenario-card:hover {
            border-color: #95a5a6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .scenario-card.selected {
            border-color: #34495e;
            background: #f8f9fa;
        }

        .scenario-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .scenario-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty-easy {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .difficulty-moderate {
            background: #fff3e0;
            color: #e65100;
        }

        .difficulty-difficult {
            background: #ffebee;
            color: #c62828;
        }

        .emotion-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.75rem;
            background: #e3f2fd;
            color: #1565c0;
        }

        .scenario-description {
            font-size: 0.85rem;
            color: #7f8c8d;
            line-height: 1.4;
        }

        /* Voice Controls Grid */
        .voice-controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        @media (max-width: 1024px) {
            .voice-controls-grid {
                grid-template-columns: 1fr;
            }
        }

        .voice-panel {
            background: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .voice-panel-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .voice-panel-icon {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .support-icon {
            background: #ecf0f1;
            color: #34495e;
        }

        .customer-icon {
            background: #fef5e7;
            color: #f39c12;
        }

        .voice-panel-title {
            flex: 1;
        }

        .voice-panel-title h2 {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 3px;
            font-weight: 600;
        }

        .voice-panel-title p {
            font-size: 0.85rem;
            color: #95a5a6;
        }

        .form-group {
            margin-bottom: 18px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #34495e;
            font-size: 0.9rem;
        }

        input, select {
            width: 100%;
            padding: 9px 12px;
            border: 1.5px solid #dce1e6;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: border-color 0.2s;
            background: white;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #95a5a6;
        }

        input[type="range"] {
            padding: 0;
            height: 36px;
        }

        .range-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .range-value {
            min-width: 55px;
            text-align: center;
            font-weight: 600;
            color: #34495e;
            background: #f8f9fa;
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }

        .help-text {
            font-size: 0.78rem;
            color: #95a5a6;
            margin-top: 4px;
            line-height: 1.3;
        }

        /* General Settings Panel */
        .general-settings {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .settings-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .settings-row {
                grid-template-columns: 1fr;
            }
        }

        /* TTS Engine Selector */
        .tts-selector {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }

        .tts-option {
            flex: 1;
            padding: 10px;
            border: 1.5px solid #dce1e6;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .tts-option:hover {
            border-color: #95a5a6;
            background: #f8f9fa;
        }

        .tts-option.selected {
            border-color: #34495e;
            background: #ecf0f1;
        }

        .tts-option input[type="radio"] {
            display: none;
        }

        .tts-option-label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 3px;
            font-size: 0.9rem;
        }

        .tts-option-desc {
            font-size: 0.75rem;
            color: #7f8c8d;
        }

        /* Generate Button Section */
        .generate-section {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #34495e;
            color: white;
        }

        .btn-primary:hover {
            background: #2c3e50;
            box-shadow: 0 4px 12px rgba(52, 73, 94, 0.3);
        }

        /* Command Display */
        .command-display {
            margin-top: 20px;
            padding: 15px;
            background: #2c3e50;
            border-radius: 4px;
            display: none;
        }

        .command-header {
            color: #ecf0f1;
            font-size: 0.9rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .command-text {
            font-family: 'Courier New', monospace;
            color: #1abc9c;
            background: #1a252f;
            padding: 15px;
            border-radius: 4px;
            font-size: 0.85rem;
            line-height: 1.5;
            word-break: break-all;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background: #34495e;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 0.75rem;
            cursor: pointer;
        }

        .copy-btn:hover {
            background: #2c3e50;
        }

        /* Tabs for OpenAI/ElevenLabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 8px 16px;
            border: 1.5px solid #dce1e6;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.2s;
            color: #7f8c8d;
        }

        .tab:hover {
            border-color: #95a5a6;
            color: #34495e;
        }

        .tab.active {
            border-color: #34495e;
            background: #34495e;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .preset-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 5px 10px;
            border: 1px solid #dce1e6;
            border-radius: 3px;
            background: white;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
            color: #34495e;
        }

        .preset-btn:hover {
            border-color: #95a5a6;
            background: #f8f9fa;
        }

        .info-text {
            background: #f8f9fa;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 0.85rem;
            color: #34495e;
            line-height: 1.5;
        }

        .role-label {
            display: inline-block;
            padding: 2px 8px;
            background: #ecf0f1;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéôÔ∏è Voice Conversation Generator</h1>
            <p>Configure and generate realistic customer support conversations</p>
        </header>

        <!-- Scenario Selection -->
        <div class="scenario-panel">
            <h2 class="panel-title">Customer Scenario Selection</h2>

            <div class="scenario-info-box">
                <strong>‚ÑπÔ∏è About Scenarios:</strong> Scenarios define the <strong>customer's personality, emotional state, and behavior</strong>.
                The support agent (‡§´‡§º‡•à‡§ú‡§º‡§æ‡§®) always maintains professional behavior regardless of scenario.
            </div>

            <div class="scenario-grid" id="scenarioGrid">
                <!-- Will be populated by JS -->
            </div>
        </div>

        <!-- General Settings -->
        <div class="general-settings">
            <h2 class="panel-title">General Settings</h2>
            <div class="settings-row">
                <div class="form-group">
                    <label>Conversation Length</label>
                    <div class="range-container">
                        <input type="range" id="maxTurns" name="max_turns" min="4" max="20" value="8">
                        <span class="range-value" id="maxTurnsValue">8</span>
                    </div>
                    <div class="help-text">Total conversation exchanges (1 turn = 1 message)</div>
                </div>

                <div class="form-group">
                    <label>TTS Engine</label>
                    <div class="tts-selector">
                        <div class="tts-option selected" onclick="selectTTS('auto')">
                            <input type="radio" id="ttsAuto" name="tts_engine" value="auto" checked>
                            <div class="tts-option-label">Auto</div>
                            <div class="tts-option-desc">Smart selection</div>
                        </div>
                        <div class="tts-option" onclick="selectTTS('openai')">
                            <input type="radio" id="ttsOpenAI" name="tts_engine" value="openai">
                            <div class="tts-option-label">OpenAI</div>
                            <div class="tts-option-desc">Fast & reliable</div>
                        </div>
                        <div class="tts-option" onclick="selectTTS('elevenlabs')">
                            <input type="radio" id="ttsElevenLabs" name="tts_engine" value="elevenlabs">
                            <div class="tts-option-label">ElevenLabs</div>
                            <div class="tts-option-desc">Premium quality</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Voice Controls Grid -->
        <div class="voice-controls-grid">
            <!-- Support Agent Panel -->
            <div class="voice-panel">
                <div class="voice-panel-header">
                    <div class="voice-panel-icon support-icon">üéß</div>
                    <div class="voice-panel-title">
                        <h2>Support Agent Voice</h2>
                        <p>‡§´‡§º‡•à‡§ú‡§º‡§æ‡§® from Jodo (Always Professional)</p>
                    </div>
                </div>

                <div class="role-label">CONSTANT BEHAVIOR</div>
                <div class="info-text">
                    The support agent maintains consistent professional behavior across all scenarios.
                    These settings control voice characteristics only.
                </div>

                <!-- Tabs for TTS engines -->
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('support', 'openai')">OpenAI</div>
                    <div class="tab" onclick="switchTab('support', 'elevenlabs')">ElevenLabs</div>
                </div>

                <!-- OpenAI Settings for Support -->
                <div id="support-openai" class="tab-content active">
                    <div class="form-group">
                        <label>Voice</label>
                        <select id="openaiVoiceSupport" name="openai_voice_support">
                            <option value="onyx" selected>Onyx (Professional Male)</option>
                            <option value="echo">Echo (Confident Male)</option>
                            <option value="fable">Fable (British Accent)</option>
                            <option value="alloy">Alloy (Neutral)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Speech Speed</label>
                        <div class="range-container">
                            <input type="range" id="openaiSpeedSupport" name="openai_speed_support"
                                   min="0.8" max="1.2" step="0.02" value="0.98">
                            <span class="range-value" id="openaiSpeedSupportValue">0.98</span>
                        </div>
                        <div class="help-text">Slightly slower for clarity</div>
                    </div>
                </div>

                <!-- ElevenLabs Settings for Support -->
                <div id="support-elevenlabs" class="tab-content">
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="applyPreset('support', 'professional')">
                            Professional
                        </button>
                        <button class="preset-btn" onclick="applyPreset('support', 'empathetic')">
                            Empathetic
                        </button>
                        <button class="preset-btn" onclick="applyPreset('support', 'firm')">
                            Firm
                        </button>
                    </div>

                    <div class="form-group">
                        <label>Voice Stability</label>
                        <div class="range-container">
                            <input type="range" id="elevenlabsStabilitySupport" name="elevenlabs_stability_support"
                                   min="0.3" max="0.8" step="0.05" value="0.55">
                            <span class="range-value" id="elevenlabsStabilitySupportValue">0.55</span>
                        </div>
                        <div class="help-text">Higher = More consistent tone</div>
                    </div>

                    <div class="form-group">
                        <label>Style (Expressiveness)</label>
                        <div class="range-container">
                            <input type="range" id="elevenlabsStyleSupport" name="elevenlabs_style_support"
                                   min="0" max="0.4" step="0.05" value="0.15">
                            <span class="range-value" id="elevenlabsStyleSupportValue">0.15</span>
                        </div>
                        <div class="help-text">Subtle emotion recommended</div>
                    </div>

                    <div class="form-group">
                        <label>Speech Speed</label>
                        <div class="range-container">
                            <input type="range" id="elevenlabsSpeedSupport" name="elevenlabs_speed_support"
                                   min="0.8" max="1.2" step="0.02" value="0.98">
                            <span class="range-value" id="elevenlabsSpeedSupportValue">0.98</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="elevenlabsSpeakerBoostSupport"
                                   name="elevenlabs_speaker_boost_support" checked>
                            <label for="elevenlabsSpeakerBoostSupport">Enable Speaker Boost</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customer Panel -->
            <div class="voice-panel">
                <div class="voice-panel-header">
                    <div class="voice-panel-icon customer-icon">üë§</div>
                    <div class="voice-panel-title">
                        <h2>Customer Voice</h2>
                        <p id="customerName">Varies by scenario</p>
                    </div>
                </div>

                <div class="role-label">SCENARIO-DRIVEN BEHAVIOR</div>
                <div class="info-text">
                    The customer's personality and responses are determined by the selected scenario.
                    These settings control voice characteristics to match the emotional state.
                </div>

                <!-- Tabs for TTS engines -->
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('customer', 'openai')">OpenAI</div>
                    <div class="tab" onclick="switchTab('customer', 'elevenlabs')">ElevenLabs</div>
                </div>

                <!-- OpenAI Settings for Customer -->
                <div id="customer-openai" class="tab-content active">
                    <div class="form-group">
                        <label>Voice</label>
                        <select id="openaiVoiceCustomer" name="openai_voice_customer">
                            <option value="echo" selected>Echo (Male)</option>
                            <option value="nova">Nova (Female)</option>
                            <option value="shimmer">Shimmer (Soft Female)</option>
                            <option value="alloy">Alloy (Neutral)</option>
                        </select>
                        <div class="help-text">Match to character gender</div>
                    </div>

                    <div class="form-group">
                        <label>Speech Speed</label>
                        <div class="range-container">
                            <input type="range" id="openaiSpeedCustomer" name="openai_speed_customer"
                                   min="0.8" max="1.3" step="0.02" value="1.0">
                            <span class="range-value" id="openaiSpeedCustomerValue">1.00</span>
                        </div>
                        <div class="help-text">Auto-adjusts based on scenario</div>
                    </div>
                </div>

                <!-- ElevenLabs Settings for Customer -->
                <div id="customer-elevenlabs" class="tab-content">
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="applyPreset('customer', 'calm')">
                            Calm
                        </button>
                        <button class="preset-btn" onclick="applyPreset('customer', 'frustrated')">
                            Frustrated
                        </button>
                        <button class="preset-btn" onclick="applyPreset('customer', 'confused')">
                            Confused
                        </button>
                        <button class="preset-btn" onclick="applyPreset('customer', 'elderly')">
                            Elderly
                        </button>
                    </div>

                    <div class="form-group">
                        <label>Voice Stability</label>
                        <div class="range-container">
                            <input type="range" id="elevenlabsStabilityCustomer" name="elevenlabs_stability_customer"
                                   min="0.3" max="0.8" step="0.05" value="0.5">
                            <span class="range-value" id="elevenlabsStabilityCustomerValue">0.50</span>
                        </div>
                        <div class="help-text">Lower = More emotional variation</div>
                    </div>

                    <div class="form-group">
                        <label>Style (Emotion Level)</label>
                        <div class="range-container">
                            <input type="range" id="elevenlabsStyleCustomer" name="elevenlabs_style_customer"
                                   min="0" max="0.5" step="0.05" value="0.2">
                            <span class="range-value" id="elevenlabsStyleCustomerValue">0.20</span>
                        </div>
                        <div class="help-text">Higher = More dramatic</div>
                    </div>

                    <div class="form-group">
                        <label>Speech Speed</label>
                        <div class="range-container">
                            <input type="range" id="elevenlabsSpeedCustomer" name="elevenlabs_speed_customer"
                                   min="0.8" max="1.3" step="0.02" value="1.0">
                            <span class="range-value" id="elevenlabsSpeedCustomerValue">1.00</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="elevenlabsSpeakerBoostCustomer"
                                   name="elevenlabs_speaker_boost_customer">
                            <label for="elevenlabsSpeakerBoostCustomer">Enable Speaker Boost</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generate Section -->
        <div class="generate-section">
            <h2 class="panel-title">Generate Command</h2>

            <div class="info-text">
                Click the button below to generate a command that you can run in your terminal.
                This allows you to see the generation progress in real-time.
            </div>

            <button type="button" class="btn btn-primary" onclick="generateCommand()">
                üéØ Generate CLI Command
            </button>

            <div class="command-display" id="commandDisplay">
                <div class="command-header">üìã Copy and run this command in your terminal:</div>
                <div class="command-text" id="commandText">
                    <button class="copy-btn" onclick="copyCommand()">Copy</button>
                    <span id="generatedCommand"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let scenarios = [];
        let selectedScenario = null;
        let generatedCommandText = '';

        // Initialize the page
        async function init() {
            await loadScenarios();
            setupRangeUpdates();
        }

        // Load scenarios from API
        async function loadScenarios() {
            try {
                const response = await fetch('/api/scenarios');
                scenarios = await response.json();

                const grid = document.getElementById('scenarioGrid');
                grid.innerHTML = scenarios.map((s, index) => `
                    <div class="scenario-card ${index === 0 ? 'selected' : ''}"
                         onclick="selectScenario('${s.id}')"
                         id="scenario-${s.id}">
                        <div class="scenario-title">${s.display_name}</div>
                        <div class="scenario-meta">
                            <span class="difficulty-badge difficulty-${s.difficulty}">${s.difficulty.toUpperCase()}</span>
                            <span class="emotion-badge">${s.emotional_state}</span>
                        </div>
                        <div class="scenario-description">${s.description}</div>
                    </div>
                `).join('');

                // Select first scenario by default
                if (scenarios.length > 0) {
                    selectScenario(scenarios[0].id);
                }
            } catch (error) {
                console.error('Failed to load scenarios:', error);
            }
        }

        // Select a scenario
        function selectScenario(scenarioId) {
            selectedScenario = scenarios.find(s => s.id === scenarioId);

            // Update UI
            document.querySelectorAll('.scenario-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.getElementById(`scenario-${scenarioId}`).classList.add('selected');

            // Update customer name display
            const customerText = `${selectedScenario.customer_name} - ${selectedScenario.emotional_state}`;
            document.getElementById('customerName').textContent = customerText;

            // Auto-adjust parameters based on scenario
            autoAdjustParameters(selectedScenario);
        }

        // Auto-adjust parameters based on scenario
        function autoAdjustParameters(scenario) {
            const emotion = scenario.emotional_state.toLowerCase();

            // Adjust OpenAI voice based on character
            if (scenario.customer_name === 'Priya' || scenario.customer_name.includes('wife')) {
                document.getElementById('openaiVoiceCustomer').value = 'nova';
            } else {
                document.getElementById('openaiVoiceCustomer').value = 'echo';
            }

            if (emotion.includes('angry') || emotion.includes('frustrated')) {
                // Angry customer settings
                document.getElementById('elevenlabsStabilityCustomer').value = 0.45;
                document.getElementById('elevenlabsStyleCustomer').value = 0.25;
                document.getElementById('elevenlabsSpeedCustomer').value = 1.1;
                document.getElementById('openaiSpeedCustomer').value = 1.05;
            } else if (scenario.id.includes('elderly')) {
                // Elderly customer settings
                document.getElementById('elevenlabsStabilityCustomer').value = 0.5;
                document.getElementById('elevenlabsStyleCustomer').value = 0.1;
                document.getElementById('elevenlabsSpeedCustomer').value = 0.9;
                document.getElementById('openaiSpeedCustomer').value = 0.9;
            } else if (emotion.includes('confused')) {
                // Confused customer settings
                document.getElementById('elevenlabsStabilityCustomer').value = 0.5;
                document.getElementById('elevenlabsStyleCustomer').value = 0.15;
                document.getElementById('elevenlabsSpeedCustomer').value = 0.95;
                document.getElementById('openaiSpeedCustomer').value = 0.95;
            } else {
                // Default cooperative settings
                document.getElementById('elevenlabsStabilityCustomer').value = 0.5;
                document.getElementById('elevenlabsStyleCustomer').value = 0.2;
                document.getElementById('elevenlabsSpeedCustomer').value = 1.0;
                document.getElementById('openaiSpeedCustomer').value = 1.0;
            }

            // Update displayed values
            updateRangeValues();
        }

        // Apply preset configurations
        function applyPreset(speaker, preset) {
            if (speaker === 'support') {
                switch(preset) {
                    case 'professional':
                        document.getElementById('elevenlabsStabilitySupport').value = 0.6;
                        document.getElementById('elevenlabsStyleSupport').value = 0.1;
                        document.getElementById('elevenlabsSpeedSupport').value = 0.98;
                        break;
                    case 'empathetic':
                        document.getElementById('elevenlabsStabilitySupport').value = 0.5;
                        document.getElementById('elevenlabsStyleSupport').value = 0.2;
                        document.getElementById('elevenlabsSpeedSupport').value = 0.95;
                        break;
                    case 'firm':
                        document.getElementById('elevenlabsStabilitySupport').value = 0.65;
                        document.getElementById('elevenlabsStyleSupport').value = 0.15;
                        document.getElementById('elevenlabsSpeedSupport').value = 1.0;
                        break;
                }
            } else {
                switch(preset) {
                    case 'calm':
                        document.getElementById('elevenlabsStabilityCustomer').value = 0.55;
                        document.getElementById('elevenlabsStyleCustomer').value = 0.15;
                        document.getElementById('elevenlabsSpeedCustomer').value = 1.0;
                        break;
                    case 'frustrated':
                        document.getElementById('elevenlabsStabilityCustomer').value = 0.4;
                        document.getElementById('elevenlabsStyleCustomer').value = 0.3;
                        document.getElementById('elevenlabsSpeedCustomer').value = 1.1;
                        break;
                    case 'confused':
                        document.getElementById('elevenlabsStabilityCustomer').value = 0.5;
                        document.getElementById('elevenlabsStyleCustomer').value = 0.15;
                        document.getElementById('elevenlabsSpeedCustomer').value = 0.95;
                        break;
                    case 'elderly':
                        document.getElementById('elevenlabsStabilityCustomer').value = 0.5;
                        document.getElementById('elevenlabsStyleCustomer').value = 0.1;
                        document.getElementById('elevenlabsSpeedCustomer').value = 0.9;
                        break;
                }
            }
            updateRangeValues();
        }

        // Select TTS engine
        function selectTTS(engine) {
            document.querySelectorAll('.tts-option').forEach(opt => {
                opt.classList.remove('selected');
            });

            const selectedOption = document.querySelector(`.tts-option input[value="${engine}"]`).parentElement;
            selectedOption.classList.add('selected');
            document.getElementById(`tts${engine.charAt(0).toUpperCase() + engine.slice(1)}`).checked = true;
        }

        // Switch tabs
        function switchTab(speaker, engine) {
            // Find the parent panel
            const panel = event.target.closest('.voice-panel');

            // Update tab active states within this panel
            panel.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Show/hide content within this panel
            panel.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            panel.querySelector(`#${speaker}-${engine}`).classList.add('active');
        }

        // Setup range value updates
        function setupRangeUpdates() {
            const ranges = [
                { id: 'maxTurns', valueId: 'maxTurnsValue' },
                // OpenAI
                { id: 'openaiSpeedSupport', valueId: 'openaiSpeedSupportValue', decimals: 2 },
                { id: 'openaiSpeedCustomer', valueId: 'openaiSpeedCustomerValue', decimals: 2 },
                // ElevenLabs Support
                { id: 'elevenlabsStabilitySupport', valueId: 'elevenlabsStabilitySupportValue', decimals: 2 },
                { id: 'elevenlabsStyleSupport', valueId: 'elevenlabsStyleSupportValue', decimals: 2 },
                { id: 'elevenlabsSpeedSupport', valueId: 'elevenlabsSpeedSupportValue', decimals: 2 },
                // ElevenLabs Customer
                { id: 'elevenlabsStabilityCustomer', valueId: 'elevenlabsStabilityCustomerValue', decimals: 2 },
                { id: 'elevenlabsStyleCustomer', valueId: 'elevenlabsStyleCustomerValue', decimals: 2 },
                { id: 'elevenlabsSpeedCustomer', valueId: 'elevenlabsSpeedCustomerValue', decimals: 2 }
            ];

            ranges.forEach(range => {
                const input = document.getElementById(range.id);
                const valueSpan = document.getElementById(range.valueId);

                if (input && valueSpan) {
                    input.addEventListener('input', () => {
                        const value = range.decimals ?
                            parseFloat(input.value).toFixed(range.decimals) :
                            input.value;
                        valueSpan.textContent = value;
                    });
                }
            });
        }

        // Update all range values
        function updateRangeValues() {
            const event = new Event('input');
            document.querySelectorAll('input[type="range"]').forEach(input => {
                input.dispatchEvent(event);
            });
        }

        // Generate CLI command
        function generateCommand() {
            if (!selectedScenario) return;

            const ttsEngine = document.querySelector('input[name="tts_engine"]:checked').value;

            // Build the command based on selected options
            let command = 'cd src && uv run python conversation_simulator.py';

            // Add scenario
            command += ` ${selectedScenario.id}`;

            // Add TTS engine flag if not auto
            if (ttsEngine === 'elevenlabs') {
                command += ' --elevenlabs';
            } else if (ttsEngine === 'openai') {
                command += ' --openai';
            }

            // Note: The conversation_simulator.py would need to be updated to accept these additional parameters
            // For now, we'll show a simplified command that works with the existing code

            generatedCommandText = command;

            // Display the command
            document.getElementById('generatedCommand').textContent = command;
            document.getElementById('commandDisplay').style.display = 'block';

            // Also show a note about monitoring output
            const commandHeader = document.querySelector('.command-header');
            commandHeader.innerHTML = `
                üìã Copy and run this command in your terminal:
                <br><small style="color: #95a5a6; font-weight: normal;">
                You'll see real-time generation progress and can stop with Ctrl+C if needed
                </small>
            `;
        }

        // Copy command to clipboard
        function copyCommand() {
            navigator.clipboard.writeText(generatedCommandText).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = '#27ae60';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#34495e';
                }, 2000);
            });
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>